function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e,n,r,o,i,s,u,a={};function c(){return r||(r=1,t=a,o=function(){if(n)return e;function t(t,e){"boolean"==typeof e&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return n=1,e=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=(new Date).getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},t.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var o=this._errors[r],i=o.message,s=(t[i]||0)+1;t[i]=s,s>=n&&(e=o,n=s)}return e},e}(),t.operation=function(e){var n=t.timeouts(e);return new o(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in t)e[n]=t[n];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],o=0;o<e.retries;o++)r.push(this.createTimeout(o,e));return t&&t.forever&&!r.length&&r.push(this.createTimeout(o,e)),r.sort((function(t,e){return t-e})),r},t.createTimeout=function(t,e){var n=e.randomize?Math.random()+1:1,r=Math.round(n*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return r=Math.min(r,e.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var o in r=[],e)"function"==typeof e[o]&&r.push(o);for(var i=0;i<r.length;i++){var s=r[i],u=e[s];e[s]=function(r){var o=t.operation(n),i=Array.prototype.slice.call(arguments,1),s=i.pop();i.push((function(t){o.retry(t)||(t&&(arguments[0]=o.mainError()),s.apply(this,arguments))})),o.attempt((function(){r.apply(e,i)}))}.bind(e,u),e[s].options=n}}),a;var t,o}function l(){return i?o:(i=1,o=c())}var f=t(function(){if(u)return s;u=1;var t=l();return s=function(e,n){return new Promise((function(r,o){var i,s=n||{};function u(t){o(t||new Error("Aborted"))}function a(t,e){t.bail?u(t):i.retry(t)?s.onRetry&&s.onRetry(t,e):o(i.mainError())}"randomize"in s||(s.randomize=!0),(i=t.operation(s)).attempt((function(t){var n;try{n=e(u,t)}catch(e){return void a(e,t)}Promise.resolve(n).then(r).catch((function(e){a(e,t)}))}))}))}}());function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t){if(Array.isArray(t))return p(t)}function m(t,e,n,r,o,i,s){try{var u=t[i](s),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){m(i,r,o,s,u,"next",t)}function u(t){m(i,r,o,s,u,"throw",t)}s(void 0)}))}}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){y(t,e,n[e])}))}return t}function b(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e.push.apply(e,n)}return e}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,u=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t){return h(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function T(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(t){return function(e){return a([t,e])}}function a(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var I=function(t){return"string"==typeof t},q=function(t){if(!function(t){return null!==t&&"object"==typeof t}(t))throw new Error("queries is not object");return new URLSearchParams(Object.entries(t).reduce((function(t,e){var n=g(e,2),r=n[0],o=n[1];return void 0!==o&&(t[r]=String(o)),t}),{})).toString()};const j=function(t){var e=t.serviceDomain,n=t.apiKey;if(!n)throw new Error("parameter is required (check serviceDomain and apiKey)");if(!I(e)||!I(n))throw new Error("parameter is not string");var r="https://".concat(e,".").concat("microcms.io","/api/").concat("v1"),o=function(){var t=d((function(t){var e,o,i,s,u,a,c,l,p;return T(this,(function(h){switch(h.label){case 0:return e=t.endpoint,o=t.contentId,i=t.queries,s=void 0===i?{}:i,u=t.requestInit,a=function(t){return function(){var e=d((function(e,n){var r;return T(this,(function(o){return[2,((r=new Headers(null==n?void 0:n.headers)).has("X-MICROCMS-API-KEY")||r.set("X-MICROCMS-API-KEY",t),fetch(e,b(v({},n),{headers:r})))]}))}));return function(t,n){return e.apply(this,arguments)}}()}(n),c=q(s),l="".concat(r,"/").concat(e).concat(o?"/".concat(o):"").concat(c?"?".concat(c):""),p=function(){var t=d((function(t){var e,n;return T(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.json()];case 1:return e=r.sent(),[2,null!=(n=e.message)?n:null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}));return function(e){return t.apply(this,arguments)}}(),[4,f(function(){var t=d((function(t){var e,n,r,o,i,s,c;return T(this,(function(f){switch(f.label){case 0:return f.trys.push([0,6,,7]),[4,a(l,b(v({},u),{method:null!==(n=null==u?void 0:u.method)&&void 0!==n?n:"GET"}))];case 1:return 429!==(e=f.sent()).status&&e.status>=400&&e.status<500?[4,p(e)]:[3,3];case 2:return r=f.sent(),[2,t(new Error("fetch API response status: ".concat(e.status).concat(r?"\n  message is `".concat(r,"`"):"")))];case 3:return e.ok?[3,5]:[4,p(e)];case 4:return o=f.sent(),[2,Promise.reject(new Error("fetch API response status: ".concat(e.status).concat(o?"\n  message is `".concat(o,"`"):"")))];case 5:return[2,"DELETE"===(null==u?void 0:u.method)?void 0:e.json()];case 6:if((i=f.sent()).data)throw i.data;if(null===(s=i.response)||void 0===s?void 0:s.data)throw i.response.data;return[2,Promise.reject(new Error("Network Error.\n  Details: ".concat(null!==(c=i.message)&&void 0!==c?c:"")))];case 7:return[2]}}))}));return function(e){return t.apply(this,arguments)}}(),{retries:2,onRetry:function(t,e){console.log(t),console.log("Waiting for retry (".concat(e,"/",2,")"))},minTimeout:5e3})];case 1:return[2,h.sent()]}}))}));return function(e){return t.apply(this,arguments)}}();return{get:function(){var t=d((function(t){var e,n,r,i,s,u;return T(this,(function(a){switch(a.label){case 0:return e=t.endpoint,n=t.contentId,r=t.queries,i=void 0===r?{}:r,s=t.customRequestInit,e?[4,o({endpoint:e,contentId:n,queries:i,requestInit:s})]:[3,2];case 1:return u=a.sent(),[3,3];case 2:u=Promise.reject(new Error("endpoint is required")),a.label=3;case 3:return[2,u]}}))}));return function(e){return t.apply(this,arguments)}}(),getList:function(){var t=d((function(t){var e,n,r,i,s;return T(this,(function(u){switch(u.label){case 0:return e=t.endpoint,n=t.queries,r=void 0===n?{}:n,i=t.customRequestInit,e?[4,o({endpoint:e,queries:r,requestInit:i})]:[3,2];case 1:return s=u.sent(),[3,3];case 2:s=Promise.reject(new Error("endpoint is required")),u.label=3;case 3:return[2,s]}}))}));return function(e){return t.apply(this,arguments)}}(),getListDetail:function(){var t=d((function(t){var e,n,r,i,s,u;return T(this,(function(a){switch(a.label){case 0:return e=t.endpoint,n=t.contentId,r=t.queries,i=void 0===r?{}:r,s=t.customRequestInit,e?[4,o({endpoint:e,contentId:n,queries:i,requestInit:s})]:[3,2];case 1:return u=a.sent(),[3,3];case 2:u=Promise.reject(new Error("endpoint is required")),a.label=3;case 3:return[2,u]}}))}));return function(e){return t.apply(this,arguments)}}(),getObject:function(){var t=d((function(t){var e,n,r,i,s;return T(this,(function(u){switch(u.label){case 0:return e=t.endpoint,n=t.queries,r=void 0===n?{}:n,i=t.customRequestInit,e?[4,o({endpoint:e,queries:r,requestInit:i})]:[3,2];case 1:return s=u.sent(),[3,3];case 2:s=Promise.reject(new Error("endpoint is required")),u.label=3;case 3:return[2,s]}}))}));return function(e){return t.apply(this,arguments)}}(),getAllContentIds:function(){var t=d((function(t){var e,n,r,i,s,u,a,c,l,f,p,h,m,d,y,g;return T(this,(function(_){switch(_.label){case 0:return e=t.endpoint,n=t.alternateField,r=t.draftKey,i=t.filters,s=t.orders,u=t.customRequestInit,[4,o({endpoint:e,queries:b(v({},a={draftKey:r,filters:i,orders:s,limit:100,fields:null!=n?n:"id",depth:0}),{limit:0}),requestInit:u})];case 1:c=_.sent(),l=c.totalCount,f=[],p=0,h=function(t){return new Promise((function(e){return setTimeout(e,t)}))},m=function(t){return t.every((function(t){return"string"==typeof t}))},_.label=2;case 2:return f.length<l?[4,o({endpoint:e,queries:b(v({},a),{offset:p}),requestInit:u})]:[3,7];case 3:if(d=_.sent(),y=d.contents,g=y.map((function(t){return t[null!=n?n:"id"]})),!m(g))throw new Error("The value of the field specified by `alternateField` is not a string.");return f=w(f).concat(w(g)),p+=100,f.length<l?[4,h(1e3)]:[3,5];case 4:_.sent(),_.label=5;case 5:_.label=6;case 6:return[3,2];case 7:return[2,f]}}))}));return function(e){return t.apply(this,arguments)}}(),getAllContents:function(){var t=d((function(t){var e,n,r,i,s,u,a,c,l,f,p;return T(this,(function(h){switch(h.label){case 0:return e=t.endpoint,n=t.queries,r=void 0===n?{}:n,i=t.customRequestInit,[4,o({endpoint:e,queries:b(v({},r),{limit:0}),requestInit:i})];case 1:s=h.sent(),u=s.totalCount,a=[],c=0,l=function(t){return new Promise((function(e){return setTimeout(e,t)}))},h.label=2;case 2:return a.length<u?[4,o({endpoint:e,queries:b(v({},r),{limit:100,offset:c}),requestInit:i})]:[3,7];case 3:return f=h.sent(),p=f.contents,a=a.concat(p),c+=100,a.length<u?[4,l(1e3)]:[3,5];case 4:h.sent(),h.label=5;case 5:h.label=6;case 6:return[3,2];case 7:return[2,a]}}))}));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=d((function(t){var e,n,r,i,s,u,a,c;return T(this,(function(l){return e=t.endpoint,n=t.contentId,r=t.content,i=t.isDraft,s=void 0!==i&&i,u=t.customRequestInit,e?(a=s?{status:"draft"}:{},c=b(v({},u),{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),[2,o({endpoint:e,contentId:n,queries:a,requestInit:c})]):[2,Promise.reject(new Error("endpoint is required"))]}))}));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=d((function(t){var e,n,r,i,s;return T(this,(function(u){return e=t.endpoint,n=t.contentId,r=t.content,i=t.customRequestInit,e?(s=b(v({},i),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),[2,o({endpoint:e,contentId:n,requestInit:s})]):[2,Promise.reject(new Error("endpoint is required"))]}))}));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=d((function(t){var e,n,r,i;return T(this,(function(s){switch(s.label){case 0:return e=t.endpoint,n=t.contentId,r=t.customRequestInit,e?n?(i=b(v({},r),{method:"DELETE",headers:{},body:void 0}),[4,o({endpoint:e,contentId:n,requestInit:i})]):[2,Promise.reject(new Error("contentId is required"))]:[2,Promise.reject(new Error("endpoint is required"))];case 1:return s.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}()}}({serviceDomain:"xxxxx",apiKey:"dH9tnKbLqzRZwuU7o503lCd6oPeBVlyeThn6",retry:!0});j.getList({endpoint:"news"}).then((t=>{console.log("getList successfully."),console.log(t)})).catch((t=>{console.log("getList failed"),console.error(t)})),j.getListDetail({endpoint:"news",contentId:"ot5ejzyxbc"}).then((t=>{console.log("getListDetail successfully."),console.log(t)})).catch((t=>{console.log("getListDetail failed"),console.error(t)})),j.getAllContentIds({endpoint:"news"}).then((t=>{console.log("getAllContentIds successfully."),console.log(t)})).catch((t=>{console.log("getAllContentIds failed"),console.error(t)})),j.getAllContents({endpoint:"news"}).then((t=>{console.log("getAllContents successfully."),console.log(t)})).catch((t=>{console.log("getAllContents failed"),console.error(t)}));
